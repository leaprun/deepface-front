"use strict";(self["webpackChunkdeepface_front"]=self["webpackChunkdeepface_front"]||[]).push([[380],{4380:function(e,r,t){t.r(r),t.d(r,{default:function(){return u}});var s=function(){var e=this,r=e._self._c;return r("div",{staticClass:"loginBody"},[r("el-form",{ref:"loginForm",staticClass:"login-box",attrs:{model:e.loginForm}},[r("h3",{staticClass:"login-title"},[e._v("欢迎登录")]),r("el-form-item",{attrs:{label:"账号",prop:"username",rules:e.rules.username}},[r("el-col",{attrs:{span:20}},[r("el-input",{attrs:{type:"text",placeholder:" 请输入账号"},on:{blur:function(r){return e.validate("username")}},model:{value:e.loginForm.username,callback:function(r){e.$set(e.loginForm,"username",r)},expression:"loginForm.username"}})],1)],1),r("el-form-item",{attrs:{label:"密码",prop:"password",rules:e.rules.password}},[r("el-col",{attrs:{span:20}},[r("el-input",{attrs:{type:"password",placeholder:" 请输入密码"},on:{blur:function(r){return e.validate("password")}},model:{value:e.loginForm.password,callback:function(r){e.$set(e.loginForm,"password",r)},expression:"loginForm.password"}})],1)],1),r("el-form-item",{attrs:{label:"验证码",prop:"vCode",rules:e.rules.vCode}},[r("el-col",{attrs:{span:10}},[r("el-input",{attrs:{type:"text",placeholder:" 请输入验证码",size:"small"},on:{blur:function(r){return e.validate("vCode")}},model:{value:e.loginForm.vCode,callback:function(r){e.$set(e.loginForm,"vCode",r)},expression:"loginForm.vCode"}})],1),r("el-col",{attrs:{span:8}},[r("el-image",{attrs:{src:e.vCodePic,fit:e.fit},on:{click:e.loadVCode}})],1)],1),r("br"),r("br"),r("el-form-item",[r("div",{staticClass:"container"},[r("el-button",{staticClass:"left",attrs:{type:"primary"},on:{click:function(r){return e.login()}}},[e._v("立即登录")]),r("el-button",{staticClass:"mid",attrs:{type:"primary"},on:{click:function(r){e.dialogFormVisible=!0}}},[e._v("忘记密码")]),r("el-button",{staticClass:"right",attrs:{type:"primary"},on:{click:function(r){return e.goRegister()}}},[e._v("注册账号")])],1)])],1),r("div",[r("el-dialog",{staticClass:"resetPsw-box",attrs:{title:"忘记密码",visible:e.dialogFormVisible,modal:!1},on:{"update:visible":function(r){e.dialogFormVisible=r}}},[r("el-form",{ref:"resetPswForm",attrs:{model:e.resetPswForm}},[r("el-form-item",{attrs:{label:"账号",prop:"username",rules:e.rules2.username}},[r("el-input",{attrs:{placeholder:"请输入账号",clearable:""},on:{blur:function(r){return e.validate2("username")}},model:{value:e.resetPswForm.username,callback:function(r){e.$set(e.resetPswForm,"username",r)},expression:"resetPswForm.username"}})],1),r("el-form-item",{attrs:{label:"新密码",prop:"password",rules:e.rules2.password}},[r("el-input",{attrs:{placeholder:"请输入密码","show-password":""},on:{blur:function(r){return e.validate2("password")}},model:{value:e.resetPswForm.password,callback:function(r){e.$set(e.resetPswForm,"password",r)},expression:"resetPswForm.password"}})],1),r("el-form-item",{attrs:{label:"确认密码",prop:"checkPsw",rules:e.rules2.checkPsw}},[r("el-input",{attrs:{placeholder:"请输入密码","show-password":""},on:{blur:function(r){return e.validate2("checkPsw")}},model:{value:e.resetPswForm.checkPsw,callback:function(r){e.$set(e.resetPswForm,"checkPsw",r)},expression:"resetPswForm.checkPsw"}})],1),r("el-form-item",{attrs:{label:"验证码",prop:"vCode",rules:e.rules2.vCode}},[r("br"),r("el-col",{attrs:{span:14}},[r("el-input",{attrs:{type:"text",placeholder:" 请输入邮箱验证码",size:"small"},on:{blur:function(r){return e.validate2("vCode")}},model:{value:e.resetPswForm.vCodeMail,callback:function(r){e.$set(e.resetPswForm,"vCodeMail",r)},expression:"resetPswForm.vCodeMail"}})],1),r("el-col",{attrs:{span:8}},[r("el-button",{on:{click:e.emailVCode}},[e._v("获取验证码")])],1)],1),r("el-form-item",[r("div",{staticClass:"container"},[r("el-button",{staticClass:"left",attrs:{type:"primary"},on:{click:e.resetPsw}},[e._v("确认")]),r("el-button",{staticClass:"right",attrs:{type:"primary"},on:{click:function(r){e.dialogFormVisible=!1}}},[e._v("取消")])],1)])],1)],1)],1)],1)},a=[],o=(t(4114),t(4603),t(7566),t(8721),t(5067)),l={data(){return{loginForm:{username:"",password:"",vCode:""},resetPswForm:{username:"",password:"",checkPsw:"",vCodeMail:""},userForm:{id:0,token:""},dialogFormVisible:!1,flag:!1,uuid:"",rules:{username:[{validator:this.checkUsername,trigger:"blur"}],password:[{validator:this.checkPassword,trigger:"blur"}],vCode:[{validator:this.checkVCode,trigger:"blue"}]},rules2:{username:[{validator:this.checkUsername,trigger:"blur"}],password:[{validator:this.checkPassword,trigger:"blur"}],checkPsw:[{validator:this.checkNewPassword,trigger:"blur"}],vCode:[{validator:this.checkVCode,trigger:"blue"}]}}},mounted(){this.getUuid()},methods:{getUuid(){o.A.get("/login/uuid").then((e=>{1==e.data.code?(this.uuid=e.data.data,localStorage.setItem("Uuid",this.uuid),this.loadVCode()):alert(e.data.msg)}))},loadVCode(){o.A.get("/vCode",{params:{len:4},responseType:"blob",headers:{Uuid:localStorage.getItem("Uuid")}}).then((e=>{this.vCodePic=URL.createObjectURL(new Blob([e.data],{type:e.headers["content-type"]}))})).catch((e=>{console.error("获取验证码失败：",e)}))},emailVCode(){o.A.get("/vCode/email",{params:{len:6,username:this.resetPswForm.username},headers:{Uuid:localStorage.getItem("Uuid")}}).then((e=>{0==e.data.code?alert("获取邮箱验证码失败"):alert(e.data.msg)}))},checkUsername(e,r,t){if(""==r)return t(new Error("账号不能为空"));t()},checkPassword(e,r,t){if(""==r)return t(new Error("新密码不能为空"));t()},checkVCode(e,r,t){if(""==r)return t(new Error("验证码不能为空"));t()},checkNewPassword(e,r,t){return""==r?t(new Error("确认密码不能为空")):r!=this.resetPswForm.password?t(new Error("两次密码必须一致")):void t()},validate(e){this.$refs.loginForm.validateField(e)},validate2(e){this.$refs.resetPswForm.validateField(e)},login(){this.$refs.loginForm.validate((e=>{e&&o.A.get("/login/login",{params:this.loginForm,headers:{Uuid:localStorage.getItem("Uuid")}}).then((e=>{1==e.data.code?(this.userForm=e.data.data,localStorage.setItem("token",this.userForm.token),this.$router.push("classes")):alert("登录失败"+e.data.msg),this.flag=0}))}))},resetPsw(){this.$refs.resetPswForm.validate((e=>{e&&o.A.put("/login/resetPsw?username="+this.resetPswForm.username+"&password="+this.resetPswForm.password+"&vCodeMail="+this.resetPswForm.vCodeMail).then((e=>{this.flag=e.data.code,1==this.flag?(alert(this.flag),this.dialogFormVisible=!1):alert("修改密码失败"+e.data.msg),this.flag=0}))}))},goRegister(){this.$router.push("register")}}},i=l,n=t(1656),d=(0,n.A)(i,s,a,!1,null,"4980adfe",null),u=d.exports}}]);
//# sourceMappingURL=380.8d5a30d6.js.map