"use strict";(self["webpackChunkdeepface_front"]=self["webpackChunkdeepface_front"]||[]).push([[697],{8697:function(e,t,a){a.r(t),a.d(t,{default:function(){return d}});var s=function(){var e=this,t=e._self._c;return t("el-container",{staticStyle:{height:"100vh",border:"1px solid #eee"}},[t("el-aside",{staticStyle:{"background-color":"rgb(238, 241, 246)",height:"100%"},attrs:{width:"200px"}},[t("el-menu",{attrs:{"default-openeds":["1","3"]}},[t("el-submenu",{attrs:{index:"1"}},[t("template",{slot:"title"},[t("i",{staticClass:"el-icon-menu"}),e._v("班级管理")]),t("router-link",{attrs:{tag:"div",to:"classes"}},[t("el-menu-item",{attrs:{index:"1-1"}},[e._v("我的班级")])],1)],2),t("el-submenu",{attrs:{index:"3"}},[t("template",{slot:"title"},[t("i",{staticClass:"el-icon-s-grid"}),e._v("考勤签到")]),t("router-link",{attrs:{tag:"div",to:"attendance"}},[t("el-menu-item",{attrs:{index:"3-1"}},[e._v("开始考勤")])],1)],2)],1)],1),t("el-container",[t("el-main",{staticStyle:{height:"calc(100vh - 60px)"}},[t("el-table",{attrs:{data:e.tableData,height:"600px"}},[t("el-table-column",{attrs:{prop:"id",label:"课程id"}}),t("el-table-column",{attrs:{prop:"name",label:"课程名称"}}),t("el-table-column",{attrs:{prop:"startTime",label:"开始时间"}}),t("el-table-column",{attrs:{prop:"endTime",label:"结束时间"}}),t("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{type:"primary",icon:"el-icon-date"},on:{click:function(t){return e.check(a.row.id)}}},[e._v(" "+e._s(a.row.isBegin?"开始考勤":"结束考勤")+" ")]),t("el-button",{attrs:{type:"primary",icon:"el-icon-s-claim"},on:{click:function(t){return e.checkInfo(a.row.id)}}},[e._v(" 考勤结果 ")])]}}])})],1),t("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:e.total,"page-size":e.pageSize,"current-page":e.start},on:{"current-change":e.handleCurrentChange}})],1),t("el-dialog",{attrs:{title:"考勤结果",visible:e.dialogCheckInfoVisible},on:{"update:visible":function(t){e.dialogCheckInfoVisible=t}}},[t("el-table",{attrs:{data:e.checkData}},[t("el-table-column",{attrs:{property:"classesId",label:"课程id"}}),t("el-table-column",{attrs:{property:"classesName",label:"课程名称"}}),t("el-table-column",{attrs:{property:"studentId",label:"学生id"}}),t("el-table-column",{attrs:{property:"studentName",label:"学生姓名"}}),t("el-table-column",{attrs:{prop:"status",label:"考勤状态",formatter:e.formatStatus}}),t("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{type:"primary",icon:"el-icon-s-claim"},on:{click:function(t){return e.checkChange(a.row.studentId)}}},[e._v(" 修改考勤 ")])]}}])})],1)],1)],1)],1)},l=[],n=(a(8111),a(116),a(1701),a(5067)),r={data(){return{tableData:[],courseData:{},total:0,pageSize:3,start:1,checkData:[],dialogCheckInfoVisible:!1,isBegin:!0}},mounted(){console.log("Classes 组件已加载");const e=localStorage.getItem("token");e&&(n.A.defaults.headers.common["token"]=e,this.loadTableData())},methods:{loadTableData(){n.A.get("/classes",{headers:{token:localStorage.getItem("token")},params:{start:this.start,pageSize:this.pageSize}}).then((e=>{this.tableData=e.data.data.rows.map((e=>({...e,isBegin:!0}))),this.total=e.data.data.total})).catch((e=>{console.error("网络请求失败：",e),this.$message.error("网络请求失败，请检查网络连接或联系管理员")}))},handleCurrentChange(e){this.start=e,this.loadTableData()},check(e){const t=this.tableData.find((t=>t.id===e));1==t.isBegin?n.A.get("/check/begin/"+e).then((e=>{1==e.data.code?(this.$message({message:"开始考勤成功",type:"success"}),t.isBegin=!t.isBegin):this.$message({message:"开始考勤失败",type:"warning"})})):n.A.get("/check/stop/"+e).then((e=>{1==e.data.code?(this.$message({message:"结束考勤成功",type:"success"}),t.isBegin=!t.isBegin):this.$message({message:"结束考勤失败",type:"warning"})}))},checkInfo(e){this.dialogCheckInfoVisible=!0,n.A.get("/check/getInfo",{params:{classesId:e}}).then((e=>{1==e.data.code?this.checkData=e.data.data:alert(e.data.msg)})).catch((e=>{console.error("网络请求失败：",e),this.$message.error("网络请求失败，请检查网络连接或联系管理员")}))},checkChange(e){const t=this.checkData.find((t=>t.studentId===e));t.status=!t.status,n.A.get("/check/update",{params:{classesId:t.classesId,studentId:t.studentId,status:t.status}}).then((e=>{1==e.data.code?this.$message({message:"修改成功",type:"success"}):alert("修改考勤结果失败"+e.data.msg)})).catch((e=>{console.error("网络请求失败：",e),this.$message.error("网络请求失败，请检查网络连接或联系管理员")}))},formatStatus(e,t,a){return a?"是":"否"}}},o=r,i=a(1656),c=(0,i.A)(o,s,l,!1,null,null,null),d=c.exports}}]);
//# sourceMappingURL=697.f65176b2.js.map